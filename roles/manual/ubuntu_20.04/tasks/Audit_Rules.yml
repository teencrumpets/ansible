- name: | 
    Audit Rules - Configuring /etc/audit/rules.d/stig.rules - V-238238, V-238239, V-238240, V-238241, 
    V-238242, V-238252, V-238253, V-238254, V-238255, V-238256, V-238257, V-238258, V-238264, V-238268, 
    V-238271, V-238277, V-238278, V-238279, V-238280, V-238281, V-238282, V-238283, V-238284, V-238285, 
    V-238286, V-238287, V-238288, V-238289, V-238290, V-238291, V-238292, V-238293, V-238294, V-238295, 
    V-238297, V-238304, V-238309, V-238310, V-238315, V-238316, V-238317, V-238318, V-238319, V-238320
  lineinfile:
    path: /etc/audit/rules.d/stig.rules
    line: "{{ item.line }}"
    state: present
    create: yes
    regexp: "{{ item.regexp }}"
  with_items:
    - { line: '-w /etc/passwd -p wa -k usergroup_modification', regexp: '^(?i)-w\s+\/etc\/passwd', managed: "{{ manage_ubuntu_V_238238 }}" }
    - { line: '-w /etc/group -p wa -k usergroup_modification', regexp: '^(?i)-w\s+\/etc\/group', managed: "{{ manage_ubuntu_V_238239 }}" }
    - { line: '-w /etc/shadow -p wa -k usergroup_modification', regexp: '^(?i)-w\s+\/etc\/shadow', managed: "{{ manage_ubuntu_V_238240 }}" }
    - { line: '-w /etc/gshadow -p wa -k usergroup_modification', regexp: '^(?i)-w\s+\/etc\/gshadow', managed: "{{ manage_ubuntu_V_238241 }}" }
    - { line: '-w /etc/security/opasswd -p wa -k usergroup_modification', regexp: '^(?i)-w\s+\/etc\/security\/opasswd', managed: "{{ manage_ubuntu_V_238242 }}" }
    - { line: '-a always,exit -F path=/bin/su -F perm=x -F auid>=1000 -F auid!=unset -k privileged-priv_change', regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/bin\/su', managed: "{{ manage_ubuntu_V_238252 }}" }
    - { line: '-a always,exit -F path=/usr/bin/chfn -F perm=x -F auid>=1000 -F auid!=unset -k privileged-chfn', regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/usr\/bin\/chfn', managed: "{{ manage_ubuntu_V_238253 }}" }
    - { line: '-a always,exit -F path=/usr/bin/mount -F perm=x -F auid>=1000 -F auid!=unset -k privileged-mount', regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/usr\/bin\/mount', managed: "{{ manage_ubuntu_V_238254 }}" }
    - { line: '-a always,exit -F path=/usr/bin/umount -F perm=x -F auid>=1000 -F auid!=unset -k privileged-umount', regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/usr\/bin\/umount', managed: "{{ manage_ubuntu_V_238255 }}" }
    - { line: '-a always,exit -F path=/usr/bin/ssh-agent -F perm=x -F auid>=1000 -F auid!=unset -k privileged-ssh', regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/usr\/bin\/ssh-agent', managed: "{{ manage_ubuntu_V_238256 }}" }
    - { line: '-a always,exit -F path=/usr/lib/openssh/ssh-keysign -F perm=x -F auid>=1000 -F auid!=unset -k privileged-ssh', regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/usr\/lib\/openssh\/ssh-keysign', managed: "{{ manage_ubuntu_V_238257 }}" }
    - { line: '-a always,exit -F arch=b32 -S setxattr,fsetxattr,lsetxattr,removexattr,fremovexattr,lremovexattr -F auid>=1000 -F auid!=4294967295 -k perm_mod', regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b32\s+-S\s+setxattr,fsetxattr,lsetxattr,removexattr,fremovexattr,lremovexattr\s+-F\s+auid>=1000\s+-F\s+auid!=4294967295\s+-k\s+perm_mod', managed: "{{ manage_ubuntu_V_238258 }}" }
    - { line: '-a always,exit -F arch=b32 -S setxattr,fsetxattr,lsetxattr,removexattr,fremovexattr,lremovexattr -F auid=0 -k perm_mod', regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b32\s+-S\s+setxattr,fsetxattr,lsetxattr,removexattr,fremovexattr,lremovexattr\s+-F\s+auid=0\s+-k\s+perm_mod', managed: "{{ manage_ubuntu_V_238258 }}" }
    - { line: '-a always,exit -F arch=b64 -S setxattr,fsetxattr,lsetxattr,removexattr,fremovexattr,lremovexattr -F auid>=1000 -F auid!=4294967295 -k perm_mod', regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b64\s+-S\s+setxattr,fsetxattr,lsetxattr,removexattr,fremovexattr,lremovexattr\s+-F\s+auid>=1000\s+-F\s+auid!=4294967295\s+-k\s+perm_mod', managed: "{{ manage_ubuntu_V_238258 }}" }
    - { line: '-a always,exit -F arch=b64 -S setxattr,fsetxattr,lsetxattr,removexattr,fremovexattr,lremovexattr -F auid=0 -k perm_mod', regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b64\s+-S\s+setxattr,fsetxattr,lsetxattr,removexattr,fremovexattr,lremovexattr\s+-F\s+auid=0\s+-k\s+perm_mod', managed: "{{ manage_ubuntu_V_238258 }}" }
    - { line: '-a always,exit -F arch=b32 -S chown,fchown,fchownat,lchown -F auid>=1000 -F auid!=4294967295 -k perm_chng', regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b32\s+-S\s+chown,fchown,fchownat,lchown', managed: "{{ manage_ubuntu_V_238264 }}" }
    - { line: '-a always,exit -F arch=b64 -S chown,fchown,fchownat,lchown -F auid>=1000 -F auid!=4294967295 -k perm_chng', regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b64\s+-S\s+chown,fchown,fchownat,lchown', managed: "{{ manage_ubuntu_V_238264 }}" }
    - { line: '-a always,exit -F arch=b32 -S chmod,fchmod,fchmodat -F auid>=1000 -F auid!=4294967295 -k perm_chng', regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b32\s+-S\s+chmod,fchmod,fchmodat', managed: "{{ manage_ubuntu_V_238268 }}" }
    - { line: '-a always,exit -F arch=b64 -S chmod,fchmod,fchmodat -F auid>=1000 -F auid!=4294967295 -k perm_chng', regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b64\s+-S\s+chmod,fchmod,fchmodat', managed: "{{ manage_ubuntu_V_238268 }}" }
    - { line: '-a always,exit -F arch=b32 -S creat,open,openat,open_by_handle_at,truncate,ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k perm_access', regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b32\s+-S\s+creat,open,openat,open_by_handle_at,truncate,ftruncate\s+-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=4294967295\s+-k\s+perm_access', managed: "{{ manage_ubuntu_V_238271 }}" }
    - { line: '-a always,exit -F arch=b32 -S creat,open,openat,open_by_handle_at,truncate,ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k perm_access', regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b32\s+-S\s+creat,open,openat,open_by_handle_at,truncate,ftruncate\s+-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=4294967295\s+-k\s+perm_access', managed: "{{ manage_ubuntu_V_238271 }}" }
    - { line: '-a always,exit -F arch=b64 -S creat,open,openat,open_by_handle_at,truncate,ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k perm_access', regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b64\s+-S\s+creat,open,openat,open_by_handle_at,truncate,ftruncate\s+-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=4294967295\s+-k\s+perm_access', managed: "{{ manage_ubuntu_V_238271 }}" }
    - { line: '-a always,exit -F arch=b64 -S creat,open,openat,open_by_handle_at,truncate,ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k perm_access', regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b64\s+-S\s+creat,open,openat,open_by_handle_at,truncate,ftruncate\s+-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=4294967295\s+-k\s+perm_access', managed: "{{ manage_ubuntu_V_238271 }}" }
    - { line: '-a always,exit -F path=/usr/bin/sudo -F perm=x -F auid>=1000 -F auid!=unset -k priv_cmd', regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/usr\/bin\/sudo\s+-F', managed: "{{ manage_ubuntu_V_238277 }}" }
    - { line: '-a always,exit -F path=/usr/bin/sudoedit -F perm=x -F auid>=1000 -F auid!=unset -k priv_cmd', regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/usr\/bin\/sudoedit', managed: "{{ manage_ubuntu_V_238278 }}" }
    - { line: '-a always,exit -F path=/usr/bin/chsh -F perm=x -F auid>=1000 -F auid!=unset -k priv_cmd', regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/usr\/bin\/chsh', managed: "{{ manage_ubuntu_V_238279 }}" }
    - { line: '-a always,exit -F path=/usr/bin/newgrp -F perm=x -F auid>=1000 -F auid!=unset -k priv_cmd', regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/usr\/bin\/newgrp', managed: "{{ manage_ubuntu_V_238280 }}" }
    - { line: '-a always,exit -F path=/usr/bin/chcon -F perm=x -F auid>=1000 -F auid!=unset -k perm_chng', regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/usr\/bin\/chcon', managed: "{{ manage_ubuntu_V_238281 }}" }
    - { line: '-a always,exit -F path=/sbin/apparmor_parser -F perm=x -F auid>=1000 -F auid!=unset -k perm_chng', regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/sbin\/apparmor_parser', managed: "{{ manage_ubuntu_V_238282 }}" }
    - { line: '-a always,exit -F path=/usr/bin/setfacl -F perm=x -F auid>=1000 -F auid!=unset -k perm_chng', regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/usr\/bin\/setfacl', managed: "{{ manage_ubuntu_V_238283 }}" }
    - { line: '-a always,exit -F path=/usr/bin/chacl -F perm=x -F auid>=1000 -F auid!=unset -k perm_chng', regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/usr\/bin\/chacl', managed: "{{ manage_ubuntu_V_238284 }}" }
    - { line: '-w /var/log/tallylog -p wa -k logins', regexp: '^(?i)-w\s+\/var\/log\/tallylog', managed: "{{ manage_ubuntu_V_238285 }}" }
    - { line: '-w /var/log/faillog -p wa -k logins', regexp: '^(?i)-w\s+\/var\/log\/faillog', managed: "{{ manage_ubuntu_V_238286 }}" }
    - { line: '-w /var/log/lastlog -p wa -k logins', regexp: '^(?i)-w\s+\/var\/log\/lastlog', managed: "{{ manage_ubuntu_V_238287 }}" }
    - { line: '-a always,exit -F path=/usr/bin/passwd -F perm=x -F auid>=1000 -F auid!=unset -k privileged-passwd', regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/usr\/bin\/passwd', managed: "{{ manage_ubuntu_V_238288 }}" }
    - { line: '-a always,exit -F path=/sbin/unix_update -F perm=x -F auid>=1000 -F auid!=unset -k privileged-unix-update', regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/sbin\/unix_update', managed: "{{ manage_ubuntu_V_238289 }}" }
    - { line: '-a always,exit -F path=/usr/bin/gpasswd -F perm=x -F auid>=1000 -F auid!=unset -k privileged-gpasswd', regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/usr\/bin\/gpasswd', managed: "{{ manage_ubuntu_V_238290 }}" }
    - { line: '-a always,exit -F path=/usr/bin/chage -F perm=x -F auid>=1000 -F auid!=unset -k privileged-chage', regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/usr\/bin\/chage', managed: "{{ manage_ubuntu_V_238291 }}" }
    - { line: '-a always,exit -F path=/usr/sbin/usermod -F perm=x -F auid>=1000 -F auid!=unset -k privileged-usermod', regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/usr\/sbin\/usermod', managed: "{{ manage_ubuntu_V_238292 }}" }
    - { line: '-a always,exit -F path=/usr/bin/crontab -F perm=x -F auid>=1000 -F auid!=unset -k privileged-crontab', regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/usr\/bin\/crontab', managed: "{{ manage_ubuntu_V_238293 }}" }
    - { line: '-a always,exit -F path=/usr/sbin/pam_timestamp_check -F perm=x -F auid>=1000 -F auid!=unset -k privileged-pam_timestamp_check', regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/usr\/sbin\/pam_timestamp_check', managed: "{{ manage_ubuntu_V_238294 }}" }
    - { line: '-a always,exit -F arch=b32 -S init_module,finit_module -F auid>=1000 -F auid!=4294967295 -k module_chng', regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b32\s+-S\s+init_module,finit_module', managed: "{{ manage_ubuntu_V_238295 }}" }
    - { line: '-a always,exit -F arch=b64 -S init_module,finit_module -F auid>=1000 -F auid!=4294967295 -k module_chng', regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b64\s+-S\s+init_module,finit_module', managed: "{{ manage_ubuntu_V_238295 }}" }
    - { line: '-a always,exit -F arch=b32 -S delete_module -F auid>=1000 -F auid!=4294967295 -k module_chng', regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b32\s+-S\s+delete_module', managed: "{{ manage_ubuntu_V_238297 }}" }
    - { line: '-a always,exit -F arch=b64 -S delete_module -F auid>=1000 -F auid!=4294967295 -k module_chng', regexp: '^(?i)-a\s+always,exit-F\s+arch=b64\s+-S\s+delete_module', managed: "{{ manage_ubuntu_V_238297 }}" }
    - { line: '-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -F key=execpriv', regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b64\s+-S\s+execve\s+-C\s+uid!=euid\s+-F\s+euid=0\s+-F\s+key=execpriv', managed: "{{ manage_ubuntu_V_238304 }}" }
    - { line: '-a always,exit -F arch=b64 -S execve -C gid!=egid -F egid=0 -F key=execpriv', regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b64\s+-S\s+execve\s+-C\s+gid!=egid\s+-F\s+egid=0\s+-F\s+key=execpriv', managed: "{{ manage_ubuntu_V_238304 }}" }
    - { line: '-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -F key=execpriv', regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b32\s+-S\s+execve\s+-C\s+uid!=euid\s+-F\s+euid=0\s+-F\s+key=execpriv', managed: "{{ manage_ubuntu_V_238304 }}" }
    - { line: '-a always,exit -F arch=b32 -S execve -C gid!=egid -F egid=0 -F key=execpriv', regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b32\s+-S\s+execve\s+-C\s+gid!=egid\s+-F\s+egid=0\s+-F\s+key=execpriv', managed: "{{ manage_ubuntu_V_238304 }}" }
    - { line: '-w /var/log/sudo.log -p wa -k maintenance', regexp: '^(?i)-w\s+\/var\/log\/sudo.log', managed: "{{ manage_ubuntu_V_238309 }}" }
    - { line: '-a always,exit -F arch=b64 -S unlink,unlinkat,rename,renameat,rmdir -F auid>=1000 -F auid!=4294967295 -k delete', regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b64\s+-S\s+unlink,unlinkat,rename,renameat,rmdir', managed: "{{ manage_ubuntu_V_238310 }}" }
    - { line: '-a always,exit -F arch=b32 -S unlink,unlinkat,rename,renameat,rmdir -F auid>=1000 -F auid!=4294967295 -k delete', regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b32\s+-S\s+unlink,unlinkat,rename,renameat,rmdir', managed: "{{ manage_ubuntu_V_238310 }}" }
    - { line: '-w /var/log/wtmp -p wa -k logins', regexp: '^(?i)-w\s+\/var\/log\/wtmp', managed: "{{ manage_ubuntu_V_238315 }}" }
    - { line: '-w /var/run/utmp -p wa -k logins', regexp: '^(?i)-w\s+\/var\/run\/utmp', managed: "{{ manage_ubuntu_V_238316 }}" }
    - { line: '-w /var/log/btmp -p wa -k logins', regexp: '^(?i)-w\s+\/var\/log\/btmp', managed: "{{ manage_ubuntu_V_238317 }}" }
    - { line: '-w /sbin/modprobe -p x -k modules', regexp: '^(?i)-w\s+\/sbin\/modprobe', managed: "{{ manage_ubuntu_V_238318 }}" }
    - { line: '-w /bin/kmod -p x -k modules', regexp: '^(?i)-w\s+\/bin\/kmod', managed: "{{ manage_ubuntu_V_238319 }}" }
    - { line: '-w /usr/sbin/fdisk -p x -k fdisk', regexp: '^(?i)-w\s+\/usr\/sbin\/fdisk', managed: "{{ manage_ubuntu_V_238320 }}" }
  notify: Reload augenrules
  when: item.managed
  
- name: | 
    Audit Rules - Configuring /etc/audit/rules.d/stig.rules - V-238238, V-238239, V-238240, V-238241, 
    V-238242, V-238252, V-238253, V-238254, V-238255, V-238256, V-238257, V-238258, V-238264, V-238268, 
    V-238271, V-238277, V-238278, V-238279, V-238280, V-238281, V-238282, V-238283, V-238284, V-238285, 
    V-238286, V-238287, V-238288, V-238289, V-238290, V-238291, V-238292, V-238293, V-238294, V-238295, 
    V-238297, V-238304, V-238309, V-238310, V-238315, V-238316, V-238317, V-238318, V-238319, V-238320
  replace:
    path: /etc/audit/rules.d/stig.rules
    regexp: "{{ item.regexp }}"
    replace: ''
  with_items:
    - { regexp: '^(?i)-w\s+\/etc\/passwd', managed: "{{ manage_ubuntu_V_238238 }}" }
    - { regexp: '^(?i)-w\s+\/etc\/group', managed: "{{ manage_ubuntu_V_238239 }}" }
    - { regexp: '^(?i)-w\s+\/etc\/shadow', managed: "{{ manage_ubuntu_V_238240 }}" }
    - { regexp: '^(?i)-w\s+\/etc\/gshadow', managed: "{{ manage_ubuntu_V_238241 }}" }
    - { regexp: '^(?i)-w\s+\/etc\/security\/opasswd', managed: "{{ manage_ubuntu_V_238242 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/bin\/su', managed: "{{ manage_ubuntu_V_238252 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/usr\/bin\/chfn', managed: "{{ manage_ubuntu_V_238253 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/usr\/bin\/mount', managed: "{{ manage_ubuntu_V_238254 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/usr\/bin\/umount', managed: "{{ manage_ubuntu_V_238255 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/usr\/bin\/ssh-agent', managed: "{{ manage_ubuntu_V_238256 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/usr\/lib\/openssh\/ssh-keysign', managed: "{{ manage_ubuntu_V_238257 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b32\s+-S\s+setxattr,fsetxattr,lsetxattr,removexattr,fremovexattr,lremovexattr\s+-F\s+auid>=1000\s+-F\s+auid!=4294967295\s+-k\s+perm_mod', managed: "{{ manage_ubuntu_V_238258 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b32\s+-S\s+setxattr,fsetxattr,lsetxattr,removexattr,fremovexattr,lremovexattr\s+-F\s+auid=0\s+-k\s+perm_mod', managed: "{{ manage_ubuntu_V_238258 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b64\s+-S\s+setxattr,fsetxattr,lsetxattr,removexattr,fremovexattr,lremovexattr\s+-F\s+auid>=1000\s+-F\s+auid!=4294967295\s+-k\s+perm_mod', managed: "{{ manage_ubuntu_V_238258 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b64\s+-S\s+setxattr,fsetxattr,lsetxattr,removexattr,fremovexattr,lremovexattr\s+-F\s+auid=0\s+-k\s+perm_mod', managed: "{{ manage_ubuntu_V_238258 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b32\s+-S\s+chown,fchown,fchownat,lchown', managed: "{{ manage_ubuntu_V_238264 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b64\s+-S\s+chown,fchown,fchownat,lchown', managed: "{{ manage_ubuntu_V_238264 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b32\s+-S\s+chmod,fchmod,fchmodat', managed: "{{ manage_ubuntu_V_238268 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b64\s+-S\s+chmod,fchmod,fchmodat', managed: "{{ manage_ubuntu_V_238268 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b32\s+-S\s+creat,open,openat,open_by_handle_at,truncate,ftruncate\s+-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=4294967295\s+-k\s+perm_access', managed: "{{ manage_ubuntu_V_238271 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b32\s+-S\s+creat,open,openat,open_by_handle_at,truncate,ftruncate\s+-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=4294967295\s+-k\s+perm_access', managed: "{{ manage_ubuntu_V_238271 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b64\s+-S\s+creat,open,openat,open_by_handle_at,truncate,ftruncate\s+-F\s+exit=-EPERM\s+-F\s+auid>=1000\s+-F\s+auid!=4294967295\s+-k\s+perm_access', managed: "{{ manage_ubuntu_V_238271 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b64\s+-S\s+creat,open,openat,open_by_handle_at,truncate,ftruncate\s+-F\s+exit=-EACCES\s+-F\s+auid>=1000\s+-F\s+auid!=4294967295\s+-k\s+perm_access', managed: "{{ manage_ubuntu_V_238271 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/usr\/bin\/sudo\s+-F', managed: "{{ manage_ubuntu_V_238277 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/usr\/bin\/sudoedit', managed: "{{ manage_ubuntu_V_238278 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/usr\/bin\/chsh', managed: "{{ manage_ubuntu_V_238279 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/usr\/bin\/newgrp', managed: "{{ manage_ubuntu_V_238280 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/usr\/bin\/chcon', managed: "{{ manage_ubuntu_V_238281 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/sbin\/apparmor_parser', managed: "{{ manage_ubuntu_V_238282 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/usr\/bin\/setfacl', managed: "{{ manage_ubuntu_V_238283 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/usr\/bin\/chacl', managed: "{{ manage_ubuntu_V_238284 }}" }
    - { regexp: '^(?i)-w\s+\/var\/log\/tallylog', managed: "{{ manage_ubuntu_V_238285 }}" }
    - { regexp: '^(?i)-w\s+\/var\/log\/faillog', managed: "{{ manage_ubuntu_V_238286 }}" }
    - { regexp: '^(?i)-w\s+\/var\/log\/lastlog', managed: "{{ manage_ubuntu_V_238287 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/usr\/bin\/passwd', managed: "{{ manage_ubuntu_V_238288 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/sbin\/unix_update', managed: "{{ manage_ubuntu_V_238289 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/usr\/bin\/gpasswd', managed: "{{ manage_ubuntu_V_238290 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/usr\/bin\/chage', managed: "{{ manage_ubuntu_V_238291 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/usr\/sbin\/usermod', managed: "{{ manage_ubuntu_V_238292 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/usr\/bin\/crontab', managed: "{{ manage_ubuntu_V_238293 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+path=\/usr\/sbin\/pam_timestamp_check', managed: "{{ manage_ubuntu_V_238294 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b32\s+-S\s+init_module,finit_module', managed: "{{ manage_ubuntu_V_238295 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b64\s+-S\s+init_module,finit_module', managed: "{{ manage_ubuntu_V_238295 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b32\s+-S\s+delete_module', managed: "{{ manage_ubuntu_V_238297 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b64\s+-S\s+delete_module', managed: "{{ manage_ubuntu_V_238297 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b64\s+-S\s+execve\s+-C\s+uid!=euid\s+-F\s+euid=0\s+-F\s+key=execpriv', managed: "{{ manage_ubuntu_V_238304 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b64\s+-S\s+execve\s+-C\s+gid!=egid\s+-F\s+egid=0\s+-F\s+key=execpriv', managed: "{{ manage_ubuntu_V_238304 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b32\s+-S\s+execve\s+-C\s+uid!=euid\s+-F\s+euid=0\s+-F\s+key=execpriv', managed: "{{ manage_ubuntu_V_238304 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b32\s+-S\s+execve\s+-C\s+gid!=egid\s+-F\s+egid=0\s+-F\s+key=execpriv', managed: "{{ manage_ubuntu_V_238304 }}" }
    - { regexp: '^(?i)-w\s+\/var\/log\/sudo.log', managed: "{{ manage_ubuntu_V_238309 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b64\s+-S\s+unlink,unlinkat,rename,renameat,rmdir', managed: "{{ manage_ubuntu_V_238310 }}" }
    - { regexp: '^(?i)-a\s+always,exit\s+-F\s+arch=b32\s+-S\s+unlink,unlinkat,rename,renameat,rmdir', managed: "{{ manage_ubuntu_V_238310 }}" }
    - { regexp: '^(?i)-w\s+\/var\/log\/wtmp', managed: "{{ manage_ubuntu_V_238315 }}" }
    - { regexp: '^(?i)-w\s+\/var\/run\/utmp', managed: "{{ manage_ubuntu_V_238316 }}" }
    - { regexp: '^(?i)-w\s+\/var\/log\/btmp', managed: "{{ manage_ubuntu_V_238317 }}" }
    - { regexp: '^(?i)-w\s+\/sbin\/modprobe', managed: "{{ manage_ubuntu_V_238318 }}" }
    - { regexp: '^(?i)-w\s+\/bin\/kmod', managed: "{{ manage_ubuntu_V_238319 }}" }
    - { regexp: '^(?i)-w\s+\/usr\/sbin\/fdisk', managed: "{{ manage_ubuntu_V_238320 }}" }
  check_mode: yes
  register: diff
  failed_when: diff.msg != "1 replacements made"
  changed_when: false
  when: item.managed
  
- name: Audit Rules - Get list of files - V-238249
  find:
    paths: /etc/audit/
    recurse: yes
    file_type: file
  register: audit_configuration_files
  when: manage_ubuntu_V_238249

- name: Audit Rules - Set audit configuration permissions - V-238249
  file:
    mode: 0640
    dest: '{{ item.path }}'
  loop: '{{ audit_configuration_files.files }}'
  when: manage_ubuntu_V_238249

- name: Audit Rules - Audit configuration owner - V-238250
  file:
    path: /etc/audit/
    state: directory
    recurse: true
    owner: root
  when: manage_ubuntu_V_238250
  
- name: Audit Rules - Audit configuration group - V-238251
  file:
    path: /etc/audit/
    state: directory
    recurse: true
    group: root
  when: manage_ubuntu_V_238251